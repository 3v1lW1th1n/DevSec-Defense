##############################################################################\n##\n## Copy-History\n##\n## From Windows PowerShell Cookbook (O'Reilly)\n## by Lee Holmes (http://www.leeholmes.com/guide)\n##\n##############################################################################\n\n<#\n\n.SYNOPSIS\n\nCopy selected commands from the history buffer into the clipboard as a script.\n\n.EXAMPLE\n\nCopy-History\nCopies the entire contents of the history buffer into the clipboard.\n\n.EXAMPLE\n\nCopy-History -5\nCopies the last five commands into the clipboard.\n\n.EXAMPLE\n\nCopy-History 2,5,8,4\nCopies commands 2,5,8, and 4.\n\n.EXAMPLE\n\nCopy-History (1..10+5+6)\nCopies commands 1 through 10, then 5, then 6, using PowerShell's array\nslicing syntax.\n\n#>\n\nparam(\n    ## The range of history IDs to copy\n    [int[]] $Range\n)\n\nSet-StrictMode -Version Latest\n\n$history = @()\n\n## If they haven't specified a range, assume it's everything\nif((-not $range) -or ($range.Count -eq 0))\n{\n    $history = @(Get-History -Count ([Int16]::MaxValue))\n}\n## If it's a negative number, copy only that many\nelseif(($range.Count -eq 1) -and ($range[0] -lt 0))\n{\n    $count = [Math]::Abs($range[0])\n    $history = (Get-History -Count $count)\n}\n## Otherwise, go through each history ID in the given range\n## and add it to our history list.\nelse\n{\n    foreach($commandId in $range)\n    {\n        if($commandId -eq -1) { $history += Get-History -Count 1 }\n        else { $history += Get-History -Id $commandId }\n    }\n}\n\n## Finally, export the history to the clipboard.\n$history | Foreach-Object { $_.CommandLine } | clip.exe
